{"pages":[],"posts":[{"title":"Detecting pervasive positive selection step by step","date":"2017-03-02T09:01:33.000Z","path":"2017-03-02-Detecting-pervasive-positive-selection.html","text":"Site-model: assumsing that the dn/ds rato is the same across branches, but different between sites[TOC] (1) multiple sequence alignment speed: muscle &gt; mafft &gt; clustalW &gt; T-Coffee accuracy: mafft &gt; muscle &gt; T-Coffee &gt; clustalW cd /home/liuhui/nature_selection/exemple/data_for_codemlmafft-linsi ../input/HLA_DQB1.aa.fasta &gt; HLA_DQB1.aa.mafft.fasta (2) convert protein alignment to cds alignmentperl /home/liuhui/nature_selection/exemple/bin/pepMfa_to_cdsMfa.pl HLA_DQB1.aa.mafft.fasta ../input/HLA_DQB1.cds.fasta &gt; HLA_DQB1.cds.mafft.fasta (3) Remove spurious sequences and columns aa sequences (construct gene tree) trimal -automated1 -in HLA_DQB1.aa.mafft.fasta -out HLA_DQB1.aa.mafft.trimal.fasta -htmlout HLA_DQB1.aa.mafft.trimal.html -colnumbering &gt; HLA_DQB1.aa.mafft.trimal.cols cds sequences (for codeml) python /home/liuhui/nature_selection/bin/MSA_triplets_gaps_removed.py HLA_DQB1.cds.mafft.fasta HLA_DQB1.cds.mafft_removed_trigaps.fasta (4) convert fasta to phylip format/home/liuhui/nature_selection/exemple/bin/convert_fasta2phylip.py HLA_DQB1.aa.mafft.trimal.fasta HLA_DQB1.aa.mafft.trimal.phy # construct tree/home/liuhui/nature_selection/exemple/bin/convert_fasta2phylip.py HLA_DQB1.cds.mafft_removed_trigaps.fasta HLA_DQB1.cds.mafft_removed_trigaps.phy # for codeml (5) construct treephyml -i HLA_DQB1.aa.mafft.trimal.phy -q -d aa -m JTT -c 4 -a esed 's/\\()\\)[0-9]\\.[^:]*:/\\1:/g' HLA_DQB1.aa.mafft.trimal.phy_phyml_tree.txt &gt; HLA_DQB1.aa.mafft.trimal.tree (6) codeml# M0M1M2M3M7M8cd /home/liuhui/nature_selection/exemple/output/mkdir HLA_DQB1_M0M1M2M3M7M8cd HLA_DQB1_M0M1M2M3M7M8codeml HLA_DQB1_M0M1M2M3M7M8.ctl# M8acd /home/liuhui/nature_selection/exemple/output/mkdir HLA_DQB1_M8acd HLA_DQB1_M8acodeml HLA_DQB1_M8a.ctl (7) significant test np: the number of parameters lnL: log-likelihood value LRT: likelihood-ratio test Model_compared Model0 np0 lnL0 Model1 np1 lnL1 df LRT pvalueM7-M8 M7 44 -5047.785978 M8 46 -5011.936805 2 71.6983 2.69719269066922e-16M0-M3 M0 43 -5214.976615 M3 47 -5011.542624 4 406.868 9.12618975872726e-87M8-M8a M8a 45 -5031.655392 M8 46 -5011.936805 1 39.4372 3.38781154892534e-10M1a-M2a M1a 44 -5036.170805 M2a 46 -5014.302814 2 43.736 3.18308524710324e-10 (8) identification of sitesM2a Bayes Empirical Bayes (BEB) analysis (Yang, Wong &amp; Nielsen 2005. Mol. Biol. Evol. 22:1107-1118)Positively selected sites (: P&gt;95%; *: P&gt;99%)(amino acids refer to 1st sequence: ENSP00000364080) Pr(w&gt;1) post mean +- SE for w 38 F 0.938 3.258 +- 0.761 55 L 0.999** 3.408 +- 0.518 66 Y 0.837 2.994 +- 0.991 86 D 0.997** 3.404 +- 0.527 99 G 0.978* 3.356 +- 0.615 99 G 0.978* 3.356 +- 0.615116 F 0.935 3.243 +- 0.766118 G 0.662 2.542 +- 1.171123 R 0.690 2.646 +- 1.182256 P 0.998** 3.406 +- 0.523257 Q 0.864 3.073 +- 0.947258 G 0.968* 3.334 +- 0.659259 P 0.776 2.838 +- 1.079260 P 0.971* 3.342 +- 0.644 M8 Bayes Empirical Bayes (BEB) analysis (Yang, Wong &amp; Nielsen 2005. Mol. Biol. Evol. 22:1107-1118)Positively selected sites (: P&gt;95%; *: P&gt;99%)(amino acids refer to 1st sequence: ENSP00000364080) Pr(w&gt;1) post mean +- SE for w 14 T 0.539 1.770 +- 1.006 38 F 0.985* 2.688 +- 0.473 42 G 0.649 1.992 +- 0.956 55 L 1.000** 2.715 +- 0.417 66 Y 0.962* 2.641 +- 0.547 86 D 0.999** 2.714 +- 0.419 99 G 0.996** 2.709 +- 0.431113 E 0.518 1.714 +- 0.948116 F 0.989* 2.694 +- 0.459117 R 0.585 1.855 +- 0.957118 G 0.927 2.564 +- 0.632123 R 0.837 2.393 +- 0.822256 P 1.000** 2.715 +- 0.418257 Q 0.956* 2.630 +- 0.569258 G 0.992** 2.700 +- 0.451259 P 0.947 2.609 +- 0.588260 P 0.993** 2.703 +- 0.443","content":"<h3 id=\"Site-model-assumsing-that-the-dn-ds-rato-is-the-same-across-branches-but-different-between-sites\"><a href=\"#Site-model-assumsing-that-the-dn-ds-rato-is-the-same-across-branches-but-different-between-sites\" class=\"headerlink\" title=\"Site-model: assumsing that the dn/ds rato is the same across branches, but different between sites\"></a>Site-model: assumsing that the dn/ds rato is the same across branches, but different between sites</h3><p>[TOC]</p>\n<h4 id=\"1-multiple-sequence-alignment\"><a href=\"#1-multiple-sequence-alignment\" class=\"headerlink\" title=\"(1) multiple sequence alignment\"></a>(1) multiple sequence alignment</h4><ul>\n<li>speed: muscle &gt; mafft &gt; clustalW &gt; T-Coffee</li>\n<li>accuracy: mafft &gt; muscle &gt; T-Coffee &gt; clustalW</li>\n</ul>\n<figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><div class=\"line\">cd /home/liuhui/nature_selection/exemple/data_for_codeml</div><div class=\"line\">mafft-linsi ../input/HLA_DQB1<span class=\"selector-class\">.aa</span><span class=\"selector-class\">.fasta</span> &gt; HLA_DQB1<span class=\"selector-class\">.aa</span><span class=\"selector-class\">.mafft</span><span class=\"selector-class\">.fasta</span></div></pre></td></tr></table></figure>\n<h4 id=\"2-convert-protein-alignment-to-cds-alignment\"><a href=\"#2-convert-protein-alignment-to-cds-alignment\" class=\"headerlink\" title=\"(2) convert protein alignment to cds alignment\"></a>(2) convert protein alignment to cds alignment</h4><figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><div class=\"line\">perl /home/liuhui/nature_selection/exemple/bin/pepMfa_to_cdsMfa<span class=\"selector-class\">.pl</span> HLA_DQB1<span class=\"selector-class\">.aa</span><span class=\"selector-class\">.mafft</span><span class=\"selector-class\">.fasta</span> ../input/HLA_DQB1<span class=\"selector-class\">.cds</span><span class=\"selector-class\">.fasta</span> &gt; HLA_DQB1<span class=\"selector-class\">.cds</span><span class=\"selector-class\">.mafft</span><span class=\"selector-class\">.fasta</span></div></pre></td></tr></table></figure>\n<h4 id=\"3-Remove-spurious-sequences-and-columns\"><a href=\"#3-Remove-spurious-sequences-and-columns\" class=\"headerlink\" title=\"(3) Remove spurious sequences and columns\"></a>(3) Remove spurious sequences and columns</h4><ul>\n<li>aa sequences  (construct gene tree)</li>\n</ul>\n<figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><div class=\"line\">trimal -automated1 -<span class=\"keyword\">in</span> HLA_DQB1<span class=\"selector-class\">.aa</span><span class=\"selector-class\">.mafft</span><span class=\"selector-class\">.fasta</span> -out HLA_DQB1<span class=\"selector-class\">.aa</span><span class=\"selector-class\">.mafft</span><span class=\"selector-class\">.trimal</span><span class=\"selector-class\">.fasta</span> -htmlout HLA_DQB1<span class=\"selector-class\">.aa</span><span class=\"selector-class\">.mafft</span><span class=\"selector-class\">.trimal</span><span class=\"selector-class\">.html</span> -colnumbering &gt; HLA_DQB1<span class=\"selector-class\">.aa</span><span class=\"selector-class\">.mafft</span><span class=\"selector-class\">.trimal</span><span class=\"selector-class\">.cols</span></div></pre></td></tr></table></figure>\n<ul>\n<li>cds sequences (for codeml)</li>\n</ul>\n<figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><div class=\"line\">python /home/liuhui/nature_selection/bin/MSA_triplets_gaps_removed<span class=\"selector-class\">.py</span> HLA_DQB1<span class=\"selector-class\">.cds</span><span class=\"selector-class\">.mafft</span><span class=\"selector-class\">.fasta</span> HLA_DQB1<span class=\"selector-class\">.cds</span><span class=\"selector-class\">.mafft_removed_trigaps</span><span class=\"selector-class\">.fasta</span></div></pre></td></tr></table></figure>\n<h4 id=\"4-convert-fasta-to-phylip-format\"><a href=\"#4-convert-fasta-to-phylip-format\" class=\"headerlink\" title=\"(4) convert fasta to phylip format\"></a>(4) convert fasta to phylip format</h4><figure class=\"highlight awk\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"regexp\">/home/</span>liuhui<span class=\"regexp\">/nature_selection/</span>exemple<span class=\"regexp\">/bin/</span>convert_fasta2phylip.py HLA_DQB1.aa.mafft.trimal.fasta HLA_DQB1.aa.mafft.trimal.phy <span class=\"comment\"># construct tree</span></div><div class=\"line\"><span class=\"regexp\">/home/</span>liuhui<span class=\"regexp\">/nature_selection/</span>exemple<span class=\"regexp\">/bin/</span>convert_fasta2phylip.py HLA_DQB1.cds.mafft_removed_trigaps.fasta HLA_DQB1.cds.mafft_removed_trigaps.phy <span class=\"comment\"># for codeml</span></div></pre></td></tr></table></figure>\n<h4 id=\"5-construct-tree\"><a href=\"#5-construct-tree\" class=\"headerlink\" title=\"(5) construct tree\"></a>(5) construct tree</h4><figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><div class=\"line\">phyml -<span class=\"selector-tag\">i</span> HLA_DQB1<span class=\"selector-class\">.aa</span><span class=\"selector-class\">.mafft</span><span class=\"selector-class\">.trimal</span><span class=\"selector-class\">.phy</span> -<span class=\"selector-tag\">q</span> -d aa -m JTT -c <span class=\"number\">4</span> -<span class=\"selector-tag\">a</span> e</div><div class=\"line\">sed <span class=\"string\">'s/\\()\\)[0-9]\\.[^:]*:/\\1:/g'</span> HLA_DQB1<span class=\"selector-class\">.aa</span><span class=\"selector-class\">.mafft</span><span class=\"selector-class\">.trimal</span><span class=\"selector-class\">.phy_phyml_tree</span><span class=\"selector-class\">.txt</span> &gt; HLA_DQB1<span class=\"selector-class\">.aa</span><span class=\"selector-class\">.mafft</span><span class=\"selector-class\">.trimal</span><span class=\"selector-class\">.tree</span></div></pre></td></tr></table></figure>\n<h4 id=\"6-codeml\"><a href=\"#6-codeml\" class=\"headerlink\" title=\"(6) codeml\"></a>(6) codeml</h4><figure class=\"highlight awk\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># M0M1M2M3M7M8</span></div><div class=\"line\">cd <span class=\"regexp\">/home/</span>liuhui<span class=\"regexp\">/nature_selection/</span>exemple<span class=\"regexp\">/output/</span></div><div class=\"line\">mkdir HLA_DQB1_M0M1M2M3M7M8</div><div class=\"line\">cd HLA_DQB1_M0M1M2M3M7M8</div><div class=\"line\">codeml HLA_DQB1_M0M1M2M3M7M8.ctl</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># M8a</span></div><div class=\"line\">cd <span class=\"regexp\">/home/</span>liuhui<span class=\"regexp\">/nature_selection/</span>exemple<span class=\"regexp\">/output/</span></div><div class=\"line\">mkdir HLA_DQB1_M8a</div><div class=\"line\">cd HLA_DQB1_M8a</div><div class=\"line\">codeml HLA_DQB1_M8a.ctl</div></pre></td></tr></table></figure>\n<h4 id=\"7-significant-test\"><a href=\"#7-significant-test\" class=\"headerlink\" title=\"(7) significant test\"></a>(7) significant test</h4><ul>\n<li>np: the number of parameters</li>\n<li>lnL: log-likelihood value</li>\n<li>LRT: likelihood-ratio test</li>\n</ul>\n<p>Model_compared  Model0  np0     lnL0    Model1  np1     lnL1    df      LRT     pvalue<br>M7-M8   M7      44      -5047.785978    M8      46      -5011.936805    2       71.6983 2.69719269066922e-16<br>M0-M3   M0      43      -5214.976615    M3      47      -5011.542624    4       406.868 9.12618975872726e-87<br>M8-M8a  M8a     45      -5031.655392    M8      46      -5011.936805    1       39.4372 3.38781154892534e-10<br>M1a-M2a M1a     44      -5036.170805    M2a     46      -5014.302814    2       43.736  3.18308524710324e-10</p>\n<h4 id=\"8-identification-of-sites\"><a href=\"#8-identification-of-sites\" class=\"headerlink\" title=\"(8) identification of sites\"></a>(8) identification of sites</h4><h5 id=\"M2a\"><a href=\"#M2a\" class=\"headerlink\" title=\"M2a\"></a>M2a</h5><blockquote>\n<p>Bayes Empirical Bayes (BEB) analysis (Yang, Wong &amp; Nielsen 2005. Mol. Biol. Evol. 22:1107-1118)<br>Positively selected sites (<em>: P&gt;95%; *</em>: P&gt;99%)<br>(amino acids refer to 1st sequence: ENSP00000364080)</p>\n</blockquote>\n<figure class=\"highlight r\"><table><tr><td class=\"code\"><pre><div class=\"line\">         Pr(w&gt;<span class=\"number\">1</span>)     post mean +- SE <span class=\"keyword\">for</span> w</div><div class=\"line\"> <span class=\"number\">38</span> <span class=\"literal\">F</span>      <span class=\"number\">0.938</span>         <span class=\"number\">3.258</span> +- <span class=\"number\">0.761</span></div><div class=\"line\"> <span class=\"number\">55</span> L      <span class=\"number\">0.999</span>**       <span class=\"number\">3.408</span> +- <span class=\"number\">0.518</span></div><div class=\"line\"> <span class=\"number\">66</span> Y      <span class=\"number\">0.837</span>         <span class=\"number\">2.994</span> +- <span class=\"number\">0.991</span></div><div class=\"line\"> <span class=\"number\">86</span> D      <span class=\"number\">0.997</span>**       <span class=\"number\">3.404</span> +- <span class=\"number\">0.527</span></div><div class=\"line\"> <span class=\"number\">99</span> G      <span class=\"number\">0.978</span>*        <span class=\"number\">3.356</span> +- <span class=\"number\">0.615</span></div><div class=\"line\"> <span class=\"number\">99</span> G      <span class=\"number\">0.978</span>*        <span class=\"number\">3.356</span> +- <span class=\"number\">0.615</span></div><div class=\"line\"><span class=\"number\">116</span> <span class=\"literal\">F</span>      <span class=\"number\">0.935</span>         <span class=\"number\">3.243</span> +- <span class=\"number\">0.766</span></div><div class=\"line\"><span class=\"number\">118</span> G      <span class=\"number\">0.662</span>         <span class=\"number\">2.542</span> +- <span class=\"number\">1.171</span></div><div class=\"line\"><span class=\"number\">123</span> R      <span class=\"number\">0.690</span>         <span class=\"number\">2.646</span> +- <span class=\"number\">1.182</span></div><div class=\"line\"><span class=\"number\">256</span> P      <span class=\"number\">0.998</span>**       <span class=\"number\">3.406</span> +- <span class=\"number\">0.523</span></div><div class=\"line\"><span class=\"number\">257</span> Q      <span class=\"number\">0.864</span>         <span class=\"number\">3.073</span> +- <span class=\"number\">0.947</span></div><div class=\"line\"><span class=\"number\">258</span> G      <span class=\"number\">0.968</span>*        <span class=\"number\">3.334</span> +- <span class=\"number\">0.659</span></div><div class=\"line\"><span class=\"number\">259</span> P      <span class=\"number\">0.776</span>         <span class=\"number\">2.838</span> +- <span class=\"number\">1.079</span></div><div class=\"line\"><span class=\"number\">260</span> P      <span class=\"number\">0.971</span>*        <span class=\"number\">3.342</span> +- <span class=\"number\">0.644</span></div></pre></td></tr></table></figure>\n<h5 id=\"M8\"><a href=\"#M8\" class=\"headerlink\" title=\"M8\"></a>M8</h5><blockquote>\n<p>Bayes Empirical Bayes (BEB) analysis (Yang, Wong &amp; Nielsen 2005. Mol. Biol. Evol. 22:1107-1118)<br>Positively selected sites (<em>: P&gt;95%; *</em>: P&gt;99%)<br>(amino acids refer to 1st sequence: ENSP00000364080)</p>\n</blockquote>\n<figure class=\"highlight r\"><table><tr><td class=\"code\"><pre><div class=\"line\">         Pr(w&gt;<span class=\"number\">1</span>)     post mean +- SE <span class=\"keyword\">for</span> w</div><div class=\"line\"> <span class=\"number\">14</span> <span class=\"literal\">T</span>      <span class=\"number\">0.539</span>         <span class=\"number\">1.770</span> +- <span class=\"number\">1.006</span></div><div class=\"line\"> <span class=\"number\">38</span> <span class=\"literal\">F</span>      <span class=\"number\">0.985</span>*        <span class=\"number\">2.688</span> +- <span class=\"number\">0.473</span></div><div class=\"line\"> <span class=\"number\">42</span> G      <span class=\"number\">0.649</span>         <span class=\"number\">1.992</span> +- <span class=\"number\">0.956</span></div><div class=\"line\"> <span class=\"number\">55</span> L      <span class=\"number\">1.000</span>**       <span class=\"number\">2.715</span> +- <span class=\"number\">0.417</span></div><div class=\"line\"> <span class=\"number\">66</span> Y      <span class=\"number\">0.962</span>*        <span class=\"number\">2.641</span> +- <span class=\"number\">0.547</span></div><div class=\"line\"> <span class=\"number\">86</span> D      <span class=\"number\">0.999</span>**       <span class=\"number\">2.714</span> +- <span class=\"number\">0.419</span></div><div class=\"line\"> <span class=\"number\">99</span> G      <span class=\"number\">0.996</span>**       <span class=\"number\">2.709</span> +- <span class=\"number\">0.431</span></div><div class=\"line\"><span class=\"number\">113</span> E      <span class=\"number\">0.518</span>         <span class=\"number\">1.714</span> +- <span class=\"number\">0.948</span></div><div class=\"line\"><span class=\"number\">116</span> <span class=\"literal\">F</span>      <span class=\"number\">0.989</span>*        <span class=\"number\">2.694</span> +- <span class=\"number\">0.459</span></div><div class=\"line\"><span class=\"number\">117</span> R      <span class=\"number\">0.585</span>         <span class=\"number\">1.855</span> +- <span class=\"number\">0.957</span></div><div class=\"line\"><span class=\"number\">118</span> G      <span class=\"number\">0.927</span>         <span class=\"number\">2.564</span> +- <span class=\"number\">0.632</span></div><div class=\"line\"><span class=\"number\">123</span> R      <span class=\"number\">0.837</span>         <span class=\"number\">2.393</span> +- <span class=\"number\">0.822</span></div><div class=\"line\"><span class=\"number\">256</span> P      <span class=\"number\">1.000</span>**       <span class=\"number\">2.715</span> +- <span class=\"number\">0.418</span></div><div class=\"line\"><span class=\"number\">257</span> Q      <span class=\"number\">0.956</span>*        <span class=\"number\">2.630</span> +- <span class=\"number\">0.569</span></div><div class=\"line\"><span class=\"number\">258</span> G      <span class=\"number\">0.992</span>**       <span class=\"number\">2.700</span> +- <span class=\"number\">0.451</span></div><div class=\"line\"><span class=\"number\">259</span> P      <span class=\"number\">0.947</span>         <span class=\"number\">2.609</span> +- <span class=\"number\">0.588</span></div><div class=\"line\"><span class=\"number\">260</span> P      <span class=\"number\">0.993</span>**       <span class=\"number\">2.703</span> +- <span class=\"number\">0.443</span></div></pre></td></tr></table></figure>\n","permalink":"//https://hui-liu.github.io/2017-03-02-Detecting-pervasive-positive-selection.html","excerpt":"","categories":[],"tags":[{"name":"Evolution","slug":"Evolution","permalink":"//https://hui-liu.github.io/tags/Evolution/"}]},{"title":"creat a blog","date":"2017-03-02T05:01:44.000Z","path":"2017-03-02-creat a blog.html","text":"1. hexo new \"new blog title\"2. edit your text using Typora3. hexo generate4. hexo deploy","content":"<figure class=\"highlight verilog\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">1</span>. hexo <span class=\"keyword\">new</span> <span class=\"string\">\"new blog title\"</span></div><div class=\"line\"><span class=\"number\">2</span>. edit your text using Typora</div><div class=\"line\"><span class=\"number\">3</span>. hexo <span class=\"keyword\">generate</span></div><div class=\"line\"><span class=\"number\">4</span>. hexo deploy</div></pre></td></tr></table></figure>","permalink":"//https://hui-liu.github.io/2017-03-02-creat a blog.html","excerpt":"","categories":[],"tags":[{"name":"notes","slug":"notes","permalink":"//https://hui-liu.github.io/tags/notes/"}]}]}